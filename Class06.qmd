---
title: "Principios de Macroeconom칤a 游땙"
subtitle: "Desempleo II"
author:
  - name: Carlos Andr칠s Yanes
    orcid: 0000-0003-0683-3727
    email: cayanes@uninorte.edu.co
    affiliations: Universidad del Norte
format: 
  revealjs:
    multiplex: true
    footer: "[Universidad del Norte](https://www.uninorte.edu.co/)"
    theme: ["options.scss"]
    slide-number: c/t
    incremental: true
    title-slide-attributes:
      data-background-image: images/input02.jpg
      data-background-size: cover  
editor: visual
---

```{r setup}
#| include: false
library(pacman)
p_load(tidyverse, scales, gapminder, ggiraph, patchwork, kableExtra, TSstudio, fontawesome, readxl, ggthemes, xaringanExtra, ggdag, viridis, knitr, dslabs, gapminder, extrafont, Ecdat, tidyverse, magrittr, janitor, kableExtra)
# Colores
red_pink <- "#e64173"
met_slate <- "#272822" # metropolis font color 
purple <- "#9370DB"
green <- "#007935"
light_green <- "#7DBA97"
orange <- "#FD5F00"
turquoise <- "#44C1C4"
# knitr options
opts_chunk$set(
  comment = "#>",
  fig.align = "center",
  fig.height = 7,
  fig.width = 10.5,
  #dpi = 300,
  #cache = T,
  warning = F,
  message = F
)  
theme_simple <- theme_bw() + theme(
  axis.line = element_line(color = met_slate),
  panel.grid = element_blank(),
  rect = element_blank(),
  strip.text = element_blank(),
  text = element_text(family = "Fira Sans", color = met_slate, size = 17),
  axis.text.x = element_text(size = 12),
  axis.text.y = element_text(size = 12),
  axis.ticks = element_blank()
)
theme_market <- theme_bw() + theme(
  axis.line = element_line(color = met_slate),
  panel.grid = element_blank(),
  rect = element_blank(),
  strip.text = element_blank(),
  text = element_text(family = "Fira Sans", color = met_slate, size = 17),
  axis.title.x = element_text(hjust = 1, size = 17),
  axis.title.y = element_text(hjust = 1, angle = 0, size = 17),
  # axis.text.x = element_text(size = 12),
  # axis.text.y = element_text(size = 12),
  axis.ticks = element_blank()
)
theme_gif <- theme_bw() + theme(
  axis.line = element_line(color = met_slate),
  panel.grid = element_blank(),
  rect = element_blank(),
  text = element_text(family = "Fira Sans", color = met_slate, size = 17),
  axis.text.x = element_text(size = 12),
  axis.text.y = element_text(size = 12),
  axis.ticks = element_blank()
)
wrapper <- function(x, ...) paste(strwrap(x, ...), collapse = "\n")
shift_axis <- function(p, y=0){
  g <- ggplotGrob(p)
  dummy <- data.frame(y=y)
  ax <- g[["grobs"]][g$layout$name == "axis-b"][[1]]
  p + annotation_custom(grid::grobTree(ax, vp = grid::viewport(y=1, height=sum(ax$height))), 
                        ymax=y, ymin=y) +
    geom_hline(aes(yintercept=y), data = dummy, size = 0.5, color = met_slate) +
    theme(axis.text.x = element_blank(), 
          axis.ticks.x = element_blank())
}
#xaringanExtra::use_scribble()

# budget line (for graphing)
budget <- function(x, wage, non_labor_income) {
  wage * (24 - x) + non_labor_income
}

# utility function = u(x, y) = C (x - A)^a (y - B)^(1-a)
utility <- function(x, y, constant = 1, alpha = 0.5, offset = 10) {
  if (offset == 0) {
    utility <- constant * (x ^ alpha) * (y ^ (1 - alpha))
  } else {
    utility <-
      constant * ((x - 1 / offset) ^ alpha) * ((y - 1 / offset) ^ (1 - alpha))
  }
  return(utility)
}

# optimal leisure hours
optimize <-
  function(non_labor_income = 0,
           wage = 4,
           alpha = 0.5,
           offset = 10) {
    if (offset == 0) {
      marginal_utility <-
        function(x) {
          ((1 - alpha) / alpha) * wage * x
        }
    } else {
      marginal_utility <- function(x) {
        (offset * x * wage + wage - alpha * (offset * x * wage + wage + 1)) / (offset * alpha)
      }
    }
    
    budget <- function(x) {
      wage * (24 - x) + non_labor_income
    }
    
    optimal_x <-
      uniroot(function(x)
        budget(x) - marginal_utility(x), c(-100, 100))$root
    
    if (optimal_x > 24) {
      optimal_x <- 24
    }
    
    return(optimal_x)
  }

# indifference curve (k = utility level)
ic <- function(x, k, constant = 1, alpha = 0.5, offset = 10) {
  if (offset == 0) {
    ic <- (k / (constant * x ^ alpha)) ^ (1 / (1 - alpha))
  } else {
    ic <- ((k * (x - 1/offset) ^ (-alpha)) / constant) ^ (1 / (1 - alpha)) + 1/offset
  }
  return(ic)
}

# not accurate enough for offset != 0
ic_slope <- function(x, k, constant = 1, alpha = 0.5, offset = 10) {
  if (offset == 0) {
    ic_slope <- alpha * ((k * x ^ (-alpha)) / constant) ^ (1 / (1 - alpha)) / ((alpha - 1) * x)
  } else {
    ic_slope <- alpha * offset * ((k * (x - 1/offset) ^ (-alpha)) / constant) ^ (1 / (1 - alpha)) / ((alpha - 1) * (offset * x - 1))
  }
  return(ic_slope)
}

```

## Lo que vamos a ver

- Ya hemos hablado de consideraciones generales
- Hoy miraremos salario m칤nimo en valores
- Analizamos la oferta de trabajo con preferencias
- Solo un poquito de pol칤tica de empleabilidad

## Determinantes del desempleo

::: fragment
```{r unemployment02, fig.cap='Tabla de salario', out.width='60%', fig.asp=.75, fig.align='center', echo=FALSE}
knitr::include_graphics("images/tabsal2024.png")
```
:::

## Determinantes del desempleo
:::fragment
```{r unemployment03, fig.cap='Tabla de ocupaciones', out.width='80%', fig.asp=.75, fig.align='center', echo=FALSE}
knitr::include_graphics("images/Distpobempleo.png")
```
:::

## Determinantes del desempleo

:::fragment
> Existen un grupo de **variables que inciden** en la existencia y persistencia del desempleo.
:::

- Salarios en otros mercados laborales
- Ingresos no laborales
- Preferencias sobre trabajo y ocio
- Condiciones de trabajo
- Prestaciones complementarias
- N칰mero de trabajadores cualificados

# Miremos mas preguntas

## Pregunta 1

Si le dan la siguiente informaci칩n

```{r, echo=FALSE}
vate <- tibble(
  "Datos ciudad" = c("Poblaci칩n total", "Poblaci칩n adulta", "Desocupados", "Fuerza Laboral"),
  "Valores" = c(6000, 4000, 200, 2000 )
)  
vate %>% 
  kable()
```

Cu치l es la tasa de desempleo?

> A. El 10% <br> B. El 20% <br> C. El 40% <br> D. El 50%

## Pregunta 1

Si le dan la siguiente informaci칩n

```{r, echo=FALSE}
vate <- tibble(
  "Datos ciudad" = c("Poblaci칩n total", "Poblaci칩n adulta", "Desocupados", "Fuerza Laboral"),
  "Valores" = c(6000, 4000, 200, 2000 )
)  
vate %>% 
  kable()
```

Cu치l es la tasa de desempleo?

> [A. El 10%]{.alert} <br> B. El 20% <br> C. El 40% <br> D. El 50%

## Pregunta 2

Carlos perdi칩 su trabajo en la fabrica de vidrios porque la econom칤a cay칩 en recesi칩n. Podemos clasificarlo como:

> A. Desempleado temporal <br> B. Desempleado friccional <br> C. Desempleado estructural <br> D. Desempleado c칤clico

## Pregunta 2

Carlos perdi칩 su trabajo en la fabrica de vidrios porque la econom칤a cay칩 en recesi칩n. Podemos clasificarlo como:

> A. Desempleado temporal <br> B. Desempleado friccional <br> C. Desempleado estructural <br> [D. Desempleado c칤clico]{.alert}

## Pregunta 3

Hay un requerimiento alto en la Guajira de Ingenieros Mec치nicos. Maria es ingeniera mec치nica anda desempleada pero vive en Barranquilla. Entra a ser clasificada como:

> A. Desempleado temporal <br> B. Desempleado friccional <br> C. Desempleado estructural <br> D. Desempleado c칤clico

## Pregunta 3

Hay un requerimiento alto en la Guajira de Ingenieros Mec치nicos. Maria es ingeniera mec치nica anda desempleada pero vive en Barranquilla. Entra a ser clasificada como:

> A. Desempleado temporal <br> B. Desempleado friccional <br> [C. Desempleado estructural]{.alert} <br> D. Desempleado c칤clico

## Pregunta 4

No es cierto que el desempleo pueda llegar a cero (o caer tan bajo), porque existe:

> A. Impuestos corporativos <br> B. Desempleo friccional <br> C. Desempleo c칤clico <br> D. Pol칤ticas gubernamentales

## Pregunta 4

No es cierto que el desempleo pueda llegar a cero (o caer tan bajo), porque existe:

> A. Impuestos corporativos <br> [B. Desempleo friccional]{.alert} <br> C. Desempleo c칤clico <br> D. Pol칤ticas gubernamentales

##  {background-image="images/bean.jpg"}

### Disposiciones en el trabajo {.r-fit-text}

## Disposici칩n a trabajar

::: fragment
::: callout-note
## Concepto
Como personas de acuerdo a las condiciones laborales y comodidades tendremos cierta disposici칩n y disponibilidad a trabajar
:::
:::

::: fragment
Debemos tener presente que por muchas ayudas (subsidio de desempleo, programas de capacitaci칩n, ferias, etc.) Las personas pueden no sentirse atraidas por las vacantes del mercado laboral.
:::

- El concepto de [salario de reserva]{.bg style="--col: #00FFFF"} $(W_r)$, sale a relucir y es de tener presente que es lo que nos impulsa en gran parte a ir a trabajar.

- La condici칩n de trabajo va:

::: fragment
$$\text{Disposici칩n}= W^* \geq W_r$$
:::

## Disposici칩n a trabajar

::::{.columns}
::: {.column width="30%"}
```{r, echo = FALSE, fig.height = 3.5, fig.width = 3.5, dev = "svg"}
supply <- function(x) 0 + (4/5)*x

ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 10.5), expand = c(0, 0), breaks = seq(0, 10, 1)) +
  scale_y_continuous(limits = c(0, 10.5), expand = c(0, 0), breaks = seq(0, 10, 1)) +
  theme_market +
  labs(x = "L", y = "w") +
  stat_function(fun = supply, color = red_pink, size = 1) +
  annotate("label", label = "S", x = 9, y = supply(9), color = red_pink, family = "Fira Sans", size = 5)
```

Tenemos una persona que es muy [lineal]{.bg style="--col: #FFFF00"} con el salario.

:::

::: {.column width="30%"}
```{r, echo = FALSE, fig.height = 3.5, fig.width = 3.5, dev = "svg"}
supply <- function(x) 1 + (1/5)*x

ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 10.5), expand = c(0, 0), breaks = seq(0, 10, 1)) +
  scale_y_continuous(limits = c(0, 10.5), expand = c(0, 0), breaks = seq(0, 10, 1)) +
  theme_market +
  labs(x = "L", y = "w") +
  stat_function(fun = supply, color = red_pink, size = 1) +
  annotate("label", label = "S", x = 5, y = supply(5), color = red_pink, family = "Fira Sans", size = 5)
```
Una persona que ya tiene un salario de reserva pero con poco esta dispuesta a trabajar mas tiempo.
:::

::: {.column width="30%"}
```{r, echo = FALSE, fig.height = 3.5, fig.width = 3.5, dev = "svg"}
supply <- function(x) 3 + (5/6)*x

ggplot(data = data.frame(x = 0), mapping = aes(x = x)) +
  scale_x_continuous(limits = c(0, 10.5), expand = c(0, 0), breaks = seq(0, 10, 1)) +
  scale_y_continuous(limits = c(0, 10.5), expand = c(0, 0), breaks = seq(0, 10, 1)) +
  theme_market +
  labs(x = "L", y = "w") +
  stat_function(fun = supply, color = red_pink, size = 1) +
  annotate("label", label = "S", x = 8, y = supply(8), color = red_pink, family = "Fira Sans", size = 5)
```
Una persona que ya tiene un salario de reserva alto y desde ah칤, ya esta dispuesta a trabajar mas tiempo.
:::
::::

##  {background-image="images/bean.jpg"}

### El problema de los ingresos no salariales {.r-fit-text}

## Disposici칩n en base a elecci칩n

::::{.columns}
::: {.column width="60%"}
```{r, dev = "svg", echo = F, fig.height = 5.5, fig.width = 5.5}
# parametros
wage_level = 2
other_income = 0
income_increase = 20
offset_level = 0
leisure_love = 0.5


optimal_x <-
  optimize(
    wage = wage_level,
    non_labor_income = other_income,
    offset = offset_level,
    alpha = leisure_love
  )
optimal_y <-
  budget(
    x = optimal_x,
    wage = wage_level,
    non_labor_income = other_income
  )
max_utility <-
  utility(
    x = optimal_x,
    y = optimal_y,
    offset = offset_level,
    alpha = leisure_love
  )

new_optimal_x <-
  optimize(
    wage = wage_level,
    non_labor_income = other_income + income_increase,
    offset = offset_level,
    alpha = leisure_love
  )
new_optimal_y <-
  budget(
    x = new_optimal_x,
    wage = wage_level,
    non_labor_income = other_income + income_increase
  )
new_max_utility <-
  utility(
    x = new_optimal_x,
    y = new_optimal_y,
    offset = offset_level,
    alpha = leisure_love
  )

ggplot() + 
  # presupuesto
  stat_function(
    data = tibble(x = 0:24),
    xlim = c(0, 24),
    aes(x = x),
    fun = budget,
    args = list(wage = wage_level, non_labor_income = other_income),
    color = green,
    size = 1
  ) +
  # annotate(
  #   geom = "label",
  #   x = 2.5,
  #   y = budget(2.5, wage = wage_level, non_labor_income = other_income),
  #   label = "Budget",
  #   color = green
  # ) +
  # best indifference curve
  stat_function(
    data = tibble(x = 1:24),
    xlim = c(0, 24),
    aes(x = x),
    fun = ic,
    args = list(k = max_utility, offset = offset_level, alpha = leisure_love),
    color = red_pink,
    size = 1
  ) +
  # annotate(
  #   geom = "label",
  #   x = 7,
  #   y = ic(7, k = max_utility),
  #   label = paste0("U = ", max_utility),
  #   color = red_pink
  # ) +
  # dotted lines to show x and y
  annotate(geom = "segment", x = 0, y = optimal_y, xend = optimal_x, yend = optimal_y,
           linetype = "dashed", color = met_slate) +
  annotate(geom = "segment", x = optimal_x, y = 0, xend = optimal_x, yend = optimal_y,
           linetype = "dashed", color = met_slate) +
  # dot at optimal point
  annotate(geom = "point", x = optimal_x, y = optimal_y, size = 2, color = met_slate) +
  labs(x = "Horas de ocio (L)", y = "Ingreso laboral (Y)") +
  scale_x_continuous(expand = c(0, 0), breaks = seq(0, 24, 4), limits = c(0, 25)) +
  scale_y_continuous(expand = c(0, 0), breaks = seq(0, 160, 20), labels = scales::dollar, limits = c(0, 165)) +
  theme_simple +
  theme(axis.title.x = element_text(margin = margin(t = 10)),
        axis.title.y = element_text(margin = margin(r = 10)))
```

:::

::: {.column width="40%"}
[P:]{.blut} Como responde una persona (trabajador) frente a un [aumento]{.under} de los ingresos no laborales?
:::
::::

## Disposici칩n en base a elecci칩n

::::{.columns}
::: {.column width="60%"}
```{r, dev = "svg", echo = F, fig.height = 5.5, fig.width = 5.5}
ggplot() + 
  # budget line
  stat_function(
    data = tibble(x = 0:24),
    xlim = c(0, 24),
    aes(x = x),
    fun = budget,
    args = list(wage = wage_level, non_labor_income = other_income),
    color = green,
    size = 1,
    alpha = 0.5
  ) +
  stat_function(
    data = tibble(x = 0:24),
    xlim = c(0, 24),
    aes(x = x),
    fun = budget,
    args = list(wage = wage_level, non_labor_income = other_income + income_increase),
    color = green,
    size = 1
  ) +
  # annotate(
  #   geom = "label",
  #   x = 2.5,
  #   y = budget(2.5, wage = wage_level, non_labor_income = other_income),
  #   label = "Budget",
  #   color = green
  # ) +
  # best indifference curve
  stat_function(
    data = tibble(x = 1:24),
    xlim = c(0, 24),
    aes(x = x),
    fun = ic,
    args = list(k = max_utility, offset = offset_level, alpha = leisure_love),
    color = red_pink,
    size = 1
  ) +
  # annotate(
  #   geom = "label",
  #   x = 7,
  #   y = ic(7, k = max_utility),
  #   label = paste0("U = ", max_utility),
  #   color = red_pink
  # ) +
  # dotted lines to show x and y
  annotate(geom = "segment", x = 0, y = optimal_y, xend = optimal_x, yend = optimal_y,
           linetype = "dashed", color = met_slate) +
  annotate(geom = "segment", x = optimal_x, y = 0, xend = optimal_x, yend = optimal_y,
           linetype = "dashed", color = met_slate) +
  # dot at optimal point
  annotate(geom = "point", x = optimal_x, y = optimal_y, size = 2, color = met_slate) +
  labs(x = "Horas de ocio (L)", y = "Ingreso laboral (Y)") +
  scale_x_continuous(expand = c(0, 0), breaks = seq(0, 24, 4), limits = c(0, 25)) +
  scale_y_continuous(expand = c(0, 0), breaks = seq(0, 160, 20), labels = scales::dollar, limits = c(0, 165)) +
  theme_simple +
  theme(axis.title.x = element_text(margin = margin(t = 10)),
        axis.title.y = element_text(margin = margin(r = 10)))
```
:::

::: {.column width="40%"}
[P:]{.blut} Como responde una persona (trabajador) frente a un [aumento]{.under} de los ingresos no laborales?
:::
::::


## Disposici칩n en base a elecci칩n

::::{.columns}
::: {.column width="60%"}
```{r, dev = "svg", echo = F, fig.height = 5.5, fig.width = 5.5}
ggplot() + 
  # budget line
  stat_function(
    data = tibble(x = 0:24),
    xlim = c(0, 24),
    aes(x = x),
    fun = budget,
    args = list(wage = wage_level, non_labor_income = other_income),
    color = green,
    size = 1,
    alpha = 0.5
  ) +
  stat_function(
    data = tibble(x = 0:24),
    xlim = c(0, 24),
    aes(x = x),
    fun = budget,
    args = list(wage = wage_level, non_labor_income = other_income + income_increase),
    color = green,
    size = 1
  ) +
  # annotate(
  #   geom = "label",
  #   x = 2.5,
  #   y = budget(2.5, wage = wage_level, non_labor_income = other_income),
  #   label = "Budget",
  #   color = green
  # ) +
  # best indifference curve
  stat_function(
    data = tibble(x = 1:24),
    xlim = c(0, 24),
    aes(x = x),
    fun = ic,
    args = list(k = max_utility, offset = offset_level, alpha = leisure_love),
    color = red_pink,
    size = 1,
    alpha = 0.5
  ) +
  stat_function(
    data = tibble(x = 1:24),
    xlim = c(0, 24),
    aes(x = x),
    fun = ic,
    args = list(k = new_max_utility, offset = offset_level, alpha = leisure_love),
    color = red_pink,
    size = 1
  ) +
  annotate(geom = "segment", x = 0, y = optimal_y, xend = optimal_x, yend = optimal_y,
           linetype = "dashed", color = met_slate, alpha = 0.5) +
  annotate(geom = "segment", x = optimal_x, y = 0, xend = optimal_x, yend = optimal_y,
           linetype = "dashed", color = met_slate, alpha = 0.5) +
  annotate(geom = "point", x = optimal_x, y = optimal_y, size = 2, color = met_slate, alpha = 0.5) +
  
  annotate(geom = "segment", x = 0, y = new_optimal_y, xend = new_optimal_x, yend = new_optimal_y,
           linetype = "dashed", color = met_slate) +
  annotate(geom = "segment", x = new_optimal_x, y = 0, xend = new_optimal_x, yend = new_optimal_y,
           linetype = "dashed", color = met_slate) +
  annotate(geom = "point", x = new_optimal_x, y = new_optimal_y, size = 2, color = met_slate) +
  
  labs(x = "Horas de ocio (L)", y = "Ingreso laboral (Y)") +
  scale_x_continuous(expand = c(0, 0), breaks = seq(0, 24, 4), limits = c(0, 25)) +
  scale_y_continuous(expand = c(0, 0), breaks = seq(0, 160, 20), labels = scales::dollar, limits = c(0, 165)) +
  theme_simple +
  theme(axis.title.x = element_text(margin = margin(t = 10)),
        axis.title.y = element_text(margin = margin(r = 10)))
```
:::

::: {.column width="40%"}
[P:]{.blut} Como responde una persona (trabajador) frente a un [aumento]{.under} de los ingresos no laborales?
<br/>
[R./]{.alert} Tiene mas **deseo** de no hacer nada y desde luego su ocio aumenta mucho mas.
<br/>
Recuerde ademas que el [trabajo]{.oranger} es un *bien* mal.
:::
::::

## Disposici칩n en base a elecci칩n

::::{.columns}
::: {.column width="60%"}
```{r, dev = "svg", echo = F, fig.height = 5.5, fig.width = 5.5}
# parameter
wage_level = 2
wage_increase = 4
other_income = 0
income_increase = 20
offset_level = 0
leisure_love = 0.5


optimal_x <-
  optimize(
    wage = wage_level,
    non_labor_income = other_income + income_increase,
    offset = offset_level,
    alpha = leisure_love
  )
optimal_y <-
  budget(
    x = optimal_x,
    wage = wage_level,
    non_labor_income = other_income + income_increase
  )
max_utility <-
  utility(
    x = optimal_x,
    y = optimal_y,
    offset = offset_level,
    alpha = leisure_love
  )

new_optimal_x <-
  optimize(
    wage = wage_level + wage_increase,
    non_labor_income = other_income + income_increase,
    offset = offset_level,
    alpha = leisure_love
  )
new_optimal_y <-
  budget(
    x = new_optimal_x,
    wage = wage_level + wage_increase,
    non_labor_income = other_income + income_increase
  )
new_max_utility <-
  utility(
    x = new_optimal_x,
    y = new_optimal_y,
    offset = offset_level,
    alpha = leisure_love
  )

ggplot() + 
  # Budget line
  stat_function(
    data = tibble(x = 0:24),
    xlim = c(0, 24),
    aes(x = x),
    fun = budget,
    args = list(wage = wage_level, non_labor_income = other_income + income_increase),
    color = green,
    size = 1
  ) +
  # best indifference curve
  stat_function(
    data = tibble(x = 1:24),
    xlim = c(0, 24),
    aes(x = x),
    fun = ic,
    args = list(k = max_utility, offset = offset_level, alpha = leisure_love),
    color = red_pink,
    size = 1
  ) +
  # annotate(
  #   geom = "label",
  #   x = 7,
  #   y = ic(7, k = max_utility),
  #   label = paste0("U = ", max_utility),
  #   color = red_pink
  # ) +
  # dotted lines to show x and y
  annotate(geom = "segment", x = 0, y = optimal_y, xend = optimal_x, yend = optimal_y,
           linetype = "dashed", color = met_slate) +
  annotate(geom = "segment", x = optimal_x, y = 0, xend = optimal_x, yend = optimal_y,
           linetype = "dashed", color = met_slate) +
  # dot at optimal point
  annotate(geom = "point", x = optimal_x, y = optimal_y, size = 2, color = met_slate) +
  labs(x = "Horas de ocio (L)", y = "Ingreso laboral (Y)") +
  scale_x_continuous(expand = c(0, 0), breaks = seq(0, 24, 4), limits = c(0, 25)) +
  scale_y_continuous(expand = c(0, 0), breaks = seq(0, 160, 20), labels = scales::dollar, limits = c(0, 165)) +
  theme_simple +
  theme(axis.title.x = element_text(margin = margin(t = 10)),
        axis.title.y = element_text(margin = margin(r = 10)))
```
:::

::: {.column width="40%"}
[P:]{.blut} Como responde una persona (trabajador) frente a un [aumento]{.oranger} de los ingresos de renta laboral?
:::
::::

## Disposici칩n en base a elecci칩n

::::{.columns}
::: {.column width="60%"}
```{r, dev = "svg", echo = F, fig.height = 5.5, fig.width = 5.5}
ggplot() + 
  # budget line
  stat_function(
    data = tibble(x = 0:24),
    xlim = c(0, 24),
    aes(x = x),
    fun = budget,
    args = list(wage = wage_level, non_labor_income = other_income + income_increase),
    color = green,
    size = 1,
    alpha = 0.5
  ) +
  stat_function(
    data = tibble(x = 0:24),
    xlim = c(0, 24),
    aes(x = x),
    fun = budget,
    args = list(wage = wage_level + wage_increase, non_labor_income = other_income + income_increase),
    color = green,
    size = 1
  ) +
  # annotate(
  #   geom = "label",
  #   x = 2.5,
  #   y = budget(2.5, wage = wage_level, non_labor_income = other_income),
  #   label = "Budget",
  #   color = green
  # ) +
  # best indifference curve
  stat_function(
    data = tibble(x = 1:24),
    xlim = c(0, 24),
    aes(x = x),
    fun = ic,
    args = list(k = max_utility, offset = offset_level, alpha = leisure_love),
    color = red_pink,
    size = 1
  ) +
  # annotate(
  #   geom = "label",
  #   x = 7,
  #   y = ic(7, k = max_utility),
  #   label = paste0("U = ", max_utility),
  #   color = red_pink
  # ) +
  # dotted lines to show x and y
  annotate(geom = "segment", x = 0, y = optimal_y, xend = optimal_x, yend = optimal_y,
           linetype = "dashed", color = met_slate) +
  annotate(geom = "segment", x = optimal_x, y = 0, xend = optimal_x, yend = optimal_y,
           linetype = "dashed", color = met_slate) +
  # dot at optimal point
  annotate(geom = "point", x = optimal_x, y = optimal_y, size = 2, color = met_slate) +
  labs(x = "Horas de ocio (L)", y = "Ingreso laboral (Y)") +
  scale_x_continuous(expand = c(0, 0), breaks = seq(0, 24, 4), limits = c(0, 25)) +
  scale_y_continuous(expand = c(0, 0), breaks = seq(0, 160, 20), labels = scales::dollar, limits = c(0, 165)) +
  theme_simple +
  theme(axis.title.x = element_text(margin = margin(t = 10)),
        axis.title.y = element_text(margin = margin(r = 10)))
```
:::

::: {.column width="40%"}
[P:]{.blut} Como responde una persona (trabajador) frente a un [aumento]{.oranger} de los ingresos de renta laboral?
:::
::::

## Disposici칩n en base a elecci칩n

::::{.columns}
::: {.column width="60%"}
```{r, dev = "svg", echo = F, fig.height = 5.5, fig.width = 5.5}
ggplot() + 
  # budget line
  stat_function(
    data = tibble(x = 0:24),
    xlim = c(0, 24),
    aes(x = x),
    fun = budget,
    args = list(wage = wage_level, non_labor_income = other_income + income_increase),
    color = green,
    size = 1,
    alpha = 0.5
  ) +
  stat_function(
    data = tibble(x = 0:24),
    xlim = c(0, 24),
    aes(x = x),
    fun = budget,
    args = list(wage = wage_level + wage_increase, non_labor_income = other_income + income_increase),
    color = green,
    size = 1
  ) +
  # annotate(
  #   geom = "label",
  #   x = 2.5,
  #   y = budget(2.5, wage = wage_level, non_labor_income = other_income),
  #   label = "Budget",
  #   color = green
  # ) +
  # best indifference curve
  stat_function(
    data = tibble(x = 1:24),
    xlim = c(0, 24),
    aes(x = x),
    fun = ic,
    args = list(k = max_utility, offset = offset_level, alpha = leisure_love),
    color = red_pink,
    size = 1,
    alpha = 0.5
  ) +
  stat_function(
    data = tibble(x = 1:24),
    xlim = c(0, 24),
    aes(x = x),
    fun = ic,
    args = list(k = new_max_utility, offset = offset_level, alpha = leisure_love),
    color = red_pink,
    size = 1
  ) +
  annotate(geom = "segment", x = 0, y = optimal_y, xend = optimal_x, yend = optimal_y,
           linetype = "dashed", color = met_slate, alpha = 0.5) +
  annotate(geom = "segment", x = optimal_x, y = 0, xend = optimal_x, yend = optimal_y,
           linetype = "dashed", color = met_slate, alpha = 0.5) +
  annotate(geom = "point", x = optimal_x, y = optimal_y, size = 2, color = met_slate, alpha = 0.5) +
  
  annotate(geom = "segment", x = 0, y = new_optimal_y, xend = new_optimal_x, yend = new_optimal_y,
           linetype = "dashed", color = met_slate) +
  annotate(geom = "segment", x = new_optimal_x, y = 0, xend = new_optimal_x, yend = new_optimal_y,
           linetype = "dashed", color = met_slate) +
  annotate(geom = "point", x = new_optimal_x, y = new_optimal_y, size = 2, color = met_slate) +
  
  labs(x = "Hours of leisure (L)", y = "Labor income (Y)") +
  scale_x_continuous(expand = c(0, 0), breaks = seq(0, 24, 4), limits = c(0, 25)) +
  scale_y_continuous(expand = c(0, 0), breaks = seq(0, 160, 20), labels = scales::dollar, limits = c(0, 165)) +
  theme_simple +
  theme(axis.title.x = element_text(margin = margin(t = 10)),
        axis.title.y = element_text(margin = margin(r = 10)))
```
:::

::: {.column width="40%"}
[P:]{.blut} Como responde una persona (trabajador) frente a un [aumento]{.oranger} de los ingresos de renta laboral?

[R./]{.alert} para este caso desear치 [trabajar]{.oranger} mas que descansar.
:::
::::


##  {background-image="images/Plantis.jpg"}

### Comparaci칩n entre trabajadores {.r-fit-text}

## Comparaci칩n entre trabajadores

::::{.columns}
::: {.column width="50%"}
#### Amantes del dinero
```{r, dev = "svg", echo = F, fig.height = 5.25, fig.width = 5.5}
# parameters
offset_level = 1
leisure_love = 0.25

ggplot() + 
  # u = 10
  stat_function(
    data = tibble(x = 1:24),
    xlim = c(0, 24),
    aes(x = x),
    fun = ic,
    args = list(k = 10, offset = offset_level, alpha = leisure_love),
    color = red_pink,
    size = 1
  ) +
    # u = 20
  stat_function(
    data = tibble(x = 1:24),
    xlim = c(0, 24),
    aes(x = x),
    fun = ic,
    args = list(k = 20, offset = offset_level, alpha = leisure_love),
    color = red_pink,
    size = 1
  ) +
  # u = 30
  stat_function(
    data = tibble(x = 1:24),
    xlim = c(0, 24),
    aes(x = x),
    fun = ic,
    args = list(k = 30, offset = offset_level, alpha = leisure_love),
    color = red_pink,
    size = 1
  ) +
  # u = 40
  stat_function(
    data = tibble(x = 1:24),
    xlim = c(0, 24),
    aes(x = x),
    fun = ic,
    args = list(k = 40, offset = offset_level, alpha = leisure_love),
    color = red_pink,
    size = 1
  ) +
  # u = 50
  stat_function(
    data = tibble(x = 1:24),
    xlim = c(0, 24),
    aes(x = x),
    fun = ic,
    args = list(k = 50, offset = offset_level, alpha = leisure_love),
    color = red_pink,
    size = 1
  ) +
  labs(x = "Horas de ocio (L)", y = "Ingreso laboral (Y)") +
  scale_x_continuous(expand = c(0, 0), breaks = seq(0, 24, 4), limits = c(0, 25)) +
  scale_y_continuous(expand = c(0, 0), breaks = seq(0, 160, 20), labels = scales::dollar, limits = c(0, 165)) +
  theme_simple +
  theme(axis.title.x = element_text(margin = margin(t = 10)),
        axis.title.y = element_text(margin = margin(r = 10)))
```
:::

::: {.column width="50%"}
#### Amantes del ocio
```{r, dev = "svg", echo = F, fig.height = 5.25, fig.width = 5.5}
# parameters
offset_level = 1
leisure_love = 0.75

ggplot() + 
  # u = 10
  stat_function(
    data = tibble(x = 1:24),
    xlim = c(0, 24),
    aes(x = x),
    fun = ic,
    args = list(k = 6, offset = offset_level, alpha = leisure_love),
    color = purple,
    size = 1
  ) +
    # u = 20
  stat_function(
    data = tibble(x = 1:24),
    xlim = c(0, 24),
    aes(x = x),
    fun = ic,
    args = list(k = 12, offset = offset_level, alpha = leisure_love),
    color = purple,
    size = 1
  ) +
  # u = 30
  stat_function(
    data = tibble(x = 1:24),
    xlim = c(0, 24),
    aes(x = x),
    fun = ic,
    args = list(k = 18, offset = offset_level, alpha = leisure_love),
    color = purple,
    size = 1
  ) +
  # u = 40
  stat_function(
    data = tibble(x = 1:24),
    xlim = c(0, 24),
    aes(x = x),
    fun = ic,
    args = list(k = 24, offset = offset_level, alpha = leisure_love),
    color = purple,
    size = 1
  ) +
  # u = 50
  stat_function(
    data = tibble(x = 1:24),
    xlim = c(0, 24),
    aes(x = x),
    fun = ic,
    args = list(k = 30, offset = offset_level, alpha = leisure_love),
    color = purple,
    size = 1
  ) +
  labs(x = "Horas de ocio (L)", y = "Ingreso laboral (Y)") +
  scale_x_continuous(expand = c(0, 0), breaks = seq(0, 24, 4), limits = c(0, 25)) +
  scale_y_continuous(expand = c(0, 0), breaks = seq(0, 160, 20), labels = scales::dollar, limits = c(0, 165)) +
  theme_simple +
  theme(axis.title.x = element_text(margin = margin(t = 10)),
        axis.title.y = element_text(margin = margin(r = 10)))
```
:::
::::

## Comparaci칩n entre trabajadores

::::{.columns}
::: {.column width="50%"}
#### Amantes del dinero
```{r, dev = "svg", echo = F, fig.height = 5.25, fig.width = 5.5}
# parameter
wage_level = 2
other_income = 10
offset_level = 0
leisure_love = 0.25


optimal_x <-
  optimize(
    wage = wage_level,
    non_labor_income = other_income,
    offset = offset_level,
    alpha = leisure_love
  )
optimal_y <-
  budget(
    x = optimal_x,
    wage = wage_level,
    non_labor_income = other_income
  )
max_utility <-
  utility(
    x = optimal_x,
    y = optimal_y,
    offset = offset_level,
    alpha = leisure_love
  )

ggplot() + 
  # Budget line
  stat_function(
    data = tibble(x = 0:24),
    xlim = c(0, 24),
    aes(x = x),
    fun = budget,
    args = list(wage = wage_level, non_labor_income = other_income),
    color = green,
    size = 1
  ) +
  # best indifference curve
  stat_function(
    data = tibble(x = 1:24),
    xlim = c(0, 24),
    aes(x = x),
    fun = ic,
    args = list(k = max_utility, offset = offset_level, alpha = leisure_love),
    color = red_pink,
    size = 1
  ) +
  # dotted lines to show x and y
  annotate(geom = "segment", x = 0, y = optimal_y, xend = optimal_x, yend = optimal_y,
           linetype = "dashed", color = met_slate) +
  annotate(geom = "segment", x = optimal_x, y = 0, xend = optimal_x, yend = optimal_y,
           linetype = "dashed", color = met_slate) +
  # dot at optimal point
  annotate(geom = "point", x = optimal_x, y = optimal_y, size = 2, color = met_slate) +
  labs(x = "Horas de ocio (L)", y = "Ingreso laboral (Y)") +
  scale_x_continuous(expand = c(0, 0), breaks = seq(0, 24, 4), limits = c(0, 25)) +
  scale_y_continuous(expand = c(0, 0), breaks = seq(0, 160, 20), labels = scales::dollar, limits = c(0, 165)) +
  theme_simple +
  theme(axis.title.x = element_text(margin = margin(t = 10)),
        axis.title.y = element_text(margin = margin(r = 10)))
```
:::

::: {.column width="50%"}
#### Amantes del ocio
```{r, dev = "svg", echo = F, fig.height = 5.25, fig.width = 5.5}
# parameter
wage_level = 2
other_income = 10
offset_level = 0
leisure_love = 0.75


optimal_x <-
  optimize(
    wage = wage_level,
    non_labor_income = other_income,
    offset = offset_level,
    alpha = leisure_love
  )
optimal_y <-
  budget(
    x = optimal_x,
    wage = wage_level,
    non_labor_income = other_income
  )
max_utility <-
  utility(
    x = optimal_x,
    y = optimal_y,
    offset = offset_level,
    alpha = leisure_love
  )

ggplot() + 
  # Budget line
  stat_function(
    data = tibble(x = 0:24),
    xlim = c(0, 24),
    aes(x = x),
    fun = budget,
    args = list(wage = wage_level, non_labor_income = other_income),
    color = green,
    size = 1
  ) +
  # best indifference curve
  stat_function(
    data = tibble(x = 1:24),
    xlim = c(0, 24),
    aes(x = x),
    fun = ic,
    args = list(k = max_utility, offset = offset_level, alpha = leisure_love),
    color = purple,
    size = 1
  ) +
  # dotted lines to show x and y
  annotate(geom = "segment", x = 0, y = optimal_y, xend = optimal_x, yend = optimal_y,
           linetype = "dashed", color = met_slate) +
  annotate(geom = "segment", x = optimal_x, y = 0, xend = optimal_x, yend = optimal_y,
           linetype = "dashed", color = met_slate) +
  # dot at optimal point
  annotate(geom = "point", x = optimal_x, y = optimal_y, size = 2, color = met_slate) +
  labs(x = "Horas de ocio (L)", y = "Ingreso laboral (Y)") +
  scale_x_continuous(expand = c(0, 0), breaks = seq(0, 24, 4), limits = c(0, 25)) +
  scale_y_continuous(expand = c(0, 0), breaks = seq(0, 160, 20), labels = scales::dollar, limits = c(0, 165)) +
  theme_simple +
  theme(axis.title.x = element_text(margin = margin(t = 10)),
        axis.title.y = element_text(margin = margin(r = 10)))
```
:::
::::

## Comparaci칩n entre trabajadores

::::{.columns}
::: {.column width="50%"}
#### Amantes del dinero
```{r, dev = "svg", echo = F, fig.height = 5.25, fig.width = 5.5}
# parameter
wage_level = 2
wage_increase = -1
other_income = 10
offset_level = 0
leisure_love = 0.25


optimal_x <-
  optimize(
    wage = wage_level,
    non_labor_income = other_income,
    offset = offset_level,
    alpha = leisure_love
  )
optimal_y <-
  budget(
    x = optimal_x,
    wage = wage_level,
    non_labor_income = other_income
  )
max_utility <-
  utility(
    x = optimal_x,
    y = optimal_y,
    offset = offset_level,
    alpha = leisure_love
  )

new_optimal_x <-
  optimize(
    wage = wage_level + wage_increase,
    non_labor_income = other_income,
    offset = offset_level,
    alpha = leisure_love
  )
new_optimal_y <-
  budget(
    x = new_optimal_x,
    wage = wage_level + wage_increase,
    non_labor_income = other_income
  )
new_max_utility <-
  utility(
    x = new_optimal_x,
    y = new_optimal_y,
    offset = offset_level,
    alpha = leisure_love
  )

ggplot() + 
  # Budget line
  stat_function(
    data = tibble(x = 0:24),
    xlim = c(0, 24),
    aes(x = x),
    fun = budget,
    args = list(wage = wage_level, non_labor_income = other_income),
    color = green,
    size = 1,
    alpha = 0.5
  ) +
  stat_function(
    data = tibble(x = 0:24),
    xlim = c(0, 24),
    aes(x = x),
    fun = budget,
    args = list(wage = wage_level + wage_increase, non_labor_income = other_income),
    color = green,
    size = 1
  ) +
  # best indifference curve
  stat_function(
    data = tibble(x = 1:24),
    xlim = c(0, 24),
    aes(x = x),
    fun = ic,
    args = list(k = max_utility, offset = offset_level, alpha = leisure_love),
    color = red_pink,
    size = 1,
    alpha = 0.5
  ) +
  stat_function(
    data = tibble(x = 1:24),
    xlim = c(0, 24),
    aes(x = x),
    fun = ic,
    args = list(k = new_max_utility, offset = offset_level, alpha = leisure_love),
    color = red_pink,
    size = 1
  ) +
  annotate(geom = "segment", x = 0, y = optimal_y, xend = optimal_x, yend = optimal_y,
           linetype = "dashed", color = met_slate, alpha = 0.5) +
  annotate(geom = "segment", x = optimal_x, y = 0, xend = optimal_x, yend = optimal_y,
           linetype = "dashed", color = met_slate, alpha = 0.5) +
  annotate(geom = "point", x = optimal_x, y = optimal_y, size = 2, color = met_slate, alpha = 0.5) +
  
  annotate(geom = "segment", x = 0, y = new_optimal_y, xend = new_optimal_x, yend = new_optimal_y,
           linetype = "dashed", color = met_slate) +
  annotate(geom = "segment", x = new_optimal_x, y = 0, xend = new_optimal_x, yend = new_optimal_y,
           linetype = "dashed", color = met_slate) +
  annotate(geom = "point", x = new_optimal_x, y = new_optimal_y, size = 2, color = met_slate) +
  labs(x = "Horas de ocio (L)", y = "Ingreso laboral (Y)") +
  scale_x_continuous(expand = c(0, 0), breaks = seq(0, 24, 4), limits = c(0, 25)) +
  scale_y_continuous(expand = c(0, 0), breaks = seq(0, 160, 20), labels = scales::dollar, limits = c(0, 165)) +
  theme_simple +
  theme(axis.title.x = element_text(margin = margin(t = 10)),
        axis.title.y = element_text(margin = margin(r = 10)))
```
:::

::: {.column width="50%"}
#### Amantes del ocio
```{r, dev = "svg", echo = F, fig.height = 5.25, fig.width = 5.5}
# parameter
wage_level = 2
wage_increase = -1
other_income = 10
offset_level = 0
leisure_love = 0.75


optimal_x <-
  optimize(
    wage = wage_level,
    non_labor_income = other_income,
    offset = offset_level,
    alpha = leisure_love
  )
optimal_y <-
  budget(
    x = optimal_x,
    wage = wage_level,
    non_labor_income = other_income
  )
max_utility <-
  utility(
    x = optimal_x,
    y = optimal_y,
    offset = offset_level,
    alpha = leisure_love
  )

new_optimal_x <-
  optimize(
    wage = wage_level + wage_increase,
    non_labor_income = other_income,
    offset = offset_level,
    alpha = leisure_love
  )
new_optimal_y <-
  budget(
    x = new_optimal_x,
    wage = wage_level + wage_increase,
    non_labor_income = other_income
  )
new_max_utility <-
  utility(
    x = new_optimal_x,
    y = new_optimal_y,
    offset = offset_level,
    alpha = leisure_love
  )

ggplot() + 
  # Budget line
  stat_function(
    data = tibble(x = 0:24),
    xlim = c(0, 24),
    aes(x = x),
    fun = budget,
    args = list(wage = wage_level, non_labor_income = other_income),
    color = green,
    size = 1,
    alpha = 0.5
  ) +
  stat_function(
    data = tibble(x = 0:24),
    xlim = c(0, 24),
    aes(x = x),
    fun = budget,
    args = list(wage = wage_level + wage_increase, non_labor_income = other_income),
    color = green,
    size = 1
  ) +
  # best indifference curve
  stat_function(
    data = tibble(x = 1:24),
    xlim = c(0, 24),
    aes(x = x),
    fun = ic,
    args = list(k = max_utility, offset = offset_level, alpha = leisure_love),
    color = purple,
    size = 1,
    alpha = 0.5
  ) +
  stat_function(
    data = tibble(x = 1:24),
    xlim = c(0, 24),
    aes(x = x),
    fun = ic,
    args = list(k = new_max_utility, offset = offset_level, alpha = leisure_love),
    color = purple,
    size = 1
  ) +
  annotate(geom = "segment", x = 0, y = optimal_y, xend = optimal_x, yend = optimal_y,
           linetype = "dashed", color = met_slate, alpha = 0.5) +
  annotate(geom = "segment", x = optimal_x, y = 0, xend = optimal_x, yend = optimal_y,
           linetype = "dashed", color = met_slate, alpha = 0.5) +
  annotate(geom = "point", x = optimal_x, y = optimal_y, size = 2, color = met_slate, alpha = 0.5) +
  
  annotate(geom = "segment", x = 0, y = new_optimal_y, xend = new_optimal_x, yend = new_optimal_y,
           linetype = "dashed", color = met_slate) +
  annotate(geom = "segment", x = new_optimal_x, y = 0, xend = new_optimal_x, yend = new_optimal_y,
           linetype = "dashed", color = met_slate) +
  annotate(geom = "point", x = new_optimal_x, y = new_optimal_y, size = 2, color = met_slate) +
  labs(x = "Horas de ocio (L)", y = "Ingreso laboral (Y)") +
  scale_x_continuous(expand = c(0, 0), breaks = seq(0, 24, 4), limits = c(0, 25)) +
  scale_y_continuous(expand = c(0, 0), breaks = seq(0, 160, 20), labels = scales::dollar, limits = c(0, 165)) +
  theme_simple +
  theme(axis.title.x = element_text(margin = margin(t = 10)),
        axis.title.y = element_text(margin = margin(r = 10)))
```
:::
::::

##  {background-image="images/Plantis.jpg"}

### Implicaciones de politica {.r-fit-text}

## La politica de empleabilidad

- En un mundo que depronto sea [igual]{.bg style="--col: #FFFF00"}  seguira siendo **desigual**, esto es porque simplemente tenemos todos preferencias [distintas]{.alert}

    - No se trata de que no se pueda reducir
    - Hay niveles sociales de convencimiento
    - Los ingresos mayores podr치n conducir al mundo a mejorar preferencias

- Lo que ha dicho el gobierno

:::fragment
> "El Estado actuar치 como empleador de 칰ltima instancia ofreciendo empleo a quienes puedan y quieran trabajar, pero no encuentran empleo en el sector privado, beneficiando principalmente a las y los desempleados, j칩venes, mujeres, trabajadores informales, las econom칤as populares y los territorios"
:::

## Bibliograf칤a

`r fa('book')` Udayan R. (2022) *Introduction to Macroeconomics*. Bookdown

`r fa('book')` Raze K., (2022) Lecture notes Course and graphics *Labour Economics*. MIMEO

`r fa('book')` Shapiro D., MacDonald D. & Greenlaw S. A., (2024)*Principles of Macroeconomics 3e: Official OpenStax*. OpenStax

`r fa('book')` Santetti M., (2023) Lecture notes Course *Introduction to Macroeconomics*. MIMEO

##  {background-image="images/salt.jpg"}

### Gracias por su atenci칩n!! {.r-fit-text}

#### cayanes\@uninorte.edu.co

#### [carlosyanes.netlify.app](https://carlosyanes.netlify.app/)

